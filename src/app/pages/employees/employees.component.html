<div class="card">
  <div class="page-header header-row">
    <div class="page-title"><mat-icon class="page-title-icon" aria-hidden="true">person</mat-icon>Employees</div>
    <div class="controls">
      <button class="btn pill" (click)="addNew()">Add Employee</button>
      <button class="btn pill" (click)="load()">Refresh</button>
    </div>
  </div>

  <table class="employees-table mat-elevation-z3">
    <thead>
      <tr>
        <th>First name</th>
        <th>Last name</th>
        <th>Monthly target</th>
        <th>Active</th>
        <th>Team</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      @for (employee of employees; track $index) {
      <tr [class.row-editing]="employee._editing">
        <td>
          @if (!employee._editing) {
          <div>{{ employee.firstName }}</div>
          }
          @if (employee._editing) {
          <input [(ngModel)]="employee.firstName" class="input tight" />
          }
        </td>
        <td>
          @if (!employee._editing) {
          <div>{{ employee.lastName }}</div>
          }
          @if (employee._editing) {
          <input [(ngModel)]="employee.lastName" class="input tight" />
          }
        </td>
        <td>
          @if (!employee._editing) {
          <div>{{ employee.monthlyHoursTarget }}</div>
          }
          @if (employee._editing) {
          <input type="number" [(ngModel)]="employee.monthlyHoursTarget" class="input tight" />
          }
        </td>
        <td>
          @if (!employee._editing) {
          <div>{{ employee.isActive ? 'Yes' : 'No' }}</div>
          }
          @if (employee._editing) {
          <select [(ngModel)]="employee.isActive" class="input small-select tight">
            <option [ngValue]="true">Yes</option>
            <option [ngValue]="false">No</option>
          </select>
          }
        </td>
        <td>
          @if (!employee._editing) {
          <div>{{ employee.team?.name ?? employee.teamId }}</div>
          }
          @if (employee._editing) {
          <select [(ngModel)]="employee.teamId" class="input tight">
            <option [ngValue]="null" disabled selected>Select a team</option>
            @for (team of teams; track $index) {
              <option [ngValue]="team.id">{{ team.name }}</option>
            }
          </select>
          }
        </td>
        <td class="actions">
          @if (!employee._editing) {
          <button class="btn pill" (click)="edit(employee)">Edit</button>
          }
          @if (employee._editing) {
          <button class="btn primary pill" (click)="save(employee)">Save</button>
          <button class="btn pill" (click)="cancel(employee)">Cancel</button>
          }
          <button class="btn danger pill" (click)="remove(employee)">Delete</button>
        </td>
      </tr>
      }
    </tbody>
  </table>
  <app-confirm [visible]="confirmState.visible" [title]="confirmState.title" [message]="confirmState.message"
    [confirmLabel]="confirmState.confirmLabel ?? null" [cancelLabel]="confirmState.cancelLabel ?? null"
    (confirmed)="onConfirmedRemove()" (cancelled)="onCancelledRemove()"></app-confirm>
</div>
