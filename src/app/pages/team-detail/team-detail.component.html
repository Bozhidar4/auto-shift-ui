<div class="card">
  <div class="header-row">
    <div class="page-title">Team Details</div>
  </div>
  @if (!team && !loading) {
  <div class="muted">Team not found</div>
  }
  @if (loading) {
  <div class="muted">Loading...</div>
  }

  @if (team) {
  <div>
    <div class="team-title-container">
      <input class="input" [(ngModel)]="team.name" placeholder="Team name" />
      <button class="btn pill primary" (click)="save()">Save</button>
      <button class="btn pill" routerLink="/teams">Back</button>
    </div>

    <h3 style="margin-top:1rem">Employees</h3>
    <div class="list">
      <table class="employee-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Hours</th>
            <th>Active</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          @for (employee of (team.employees || []); track $index) {
          <tr class="employee-table-row">
            @if (employee.id && employee.id !== 0) {
            <td>{{ employee.firstName }} {{ employee.lastName }}</td>
            <td>{{ employee.monthlyHoursTarget || 160 }}</td>
            <td><input type="checkbox" [(ngModel)]="employee.isActive" disabled="disabled" />
            </td>
            <td style="padding:0.5rem; display:flex; justify-content: flex-end;">
              <button class="btn pill danger" (click)="removeEmployee(employee)">Remove</button>
            </td>
            }
            @if (employee.id === 0) {
            <td style="padding:0.5rem" colspan="1">
              <select class="input" [(ngModel)]="employee.id" (ngModelChange)="onAvailableSelected(employee, $event)">
                <option [ngValue]="null">Select employee</option>
                @for (availableEmployee of availableEmployees; track $index) {
                <option [ngValue]="availableEmployee.id">{{ availableEmployee.firstName }} {{ availableEmployee.lastName }}</option>
                }
              </select>
            </td>
            <td style="padding:0.5rem">
              <button class="btn pill" (click)="removeEmployee(employee)">Cancel</button>
            </td>
            }
          </tr>
          }
          <tr>
            <td colspan="4" style="padding:0.5rem; text-align:left">
              <button class="btn pill" (click)="addEmployee()">Add Employee</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <h3>Shift Types</h3>
    <div class="list">
      @for (shiftType of (team.shiftTypes || []); track $index) {
      <div class="shift-type-container">
        <input class="input" [(ngModel)]="shiftType.name" placeholder="Shift name" />
        <input class="input" [(ngModel)]="shiftType.startTime" placeholder="Start" />
        <input class="input" [(ngModel)]="shiftType.endTime" placeholder="End" />
        <input class="input" type="number" [(ngModel)]="shiftType.requiredPeople" placeholder="Required people"
          style="width:160px" />
        <button class="btn pill danger" (click)="removeShift(shiftType)">Remove</button>
      </div>
      }
    </div>
  </div>
  }
</div>